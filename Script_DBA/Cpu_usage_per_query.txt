    --WITH CPU_Per_Db
    --AS
    --(SELECT 
    -- dmpa.DatabaseID
    -- , DB_Name(dmpa.DatabaseID) AS [Database]
    -- , SUM(dmqs.total_worker_time) AS CPUTimeAsMS
    -- FROM sys.dm_exec_query_stats dmqs 
    -- CROSS APPLY 
    -- (SELECT 
    -- CONVERT(INT, value) AS [DatabaseID] 
    -- FROM sys.dm_exec_plan_attributes(dmqs.plan_handle)
    -- WHERE attribute = N'dbid') dmpa
    -- GROUP BY dmpa.DatabaseID)
     
    -- SELECT 
    -- [Database] 
    -- ,[CPUTimeAsMS] 
    -- ,CAST([CPUTimeAsMS] * 1.0 / SUM([CPUTimeAsMS]) OVER() * 100.0 AS DECIMAL(5, 2)) AS [CPUTimeAs%]
    -- FROM CPU_Per_Db
    -- ORDER BY [CPUTimeAs%] DESC;


	 --SELECT total_worker_time,max_worker_time,* FROM  sys.dm_exec_query_stats

 WITH CPU_Per_Db
    AS
    (SELECT 
     dmpa.DatabaseID
     , DB_Name(dmpa.DatabaseID) AS [Database]
  	 ,st.text ,dmqs.total_worker_time
     FROM sys.dm_exec_query_stats dmqs 
     CROSS APPLY 
     (SELECT 
     CONVERT(INT, value) AS [DatabaseID] 
     FROM sys.dm_exec_plan_attributes(dmqs.plan_handle)
     WHERE attribute = N'dbid') dmpa
	 CROSS APPLY
	 sys.dm_exec_sql_text(dmqs.sql_handle) st
	 )     
     SELECT *
     FROM CPU_Per_Db
	 WHERE CPU_Per_Db.[Database]='Bazresi'
	 ORDER BY CPU_Per_Db.total_worker_time DESC